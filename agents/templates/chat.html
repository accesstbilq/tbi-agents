<!DOCTYPE html>
<html class="dark" lang="en">
  <head>
    {% load static %}
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Web Agency Chatbot</title>

    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&family=Space+Grotesk:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
      rel="stylesheet"
    />

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: "#A9A0F4",
              "background-light": "#F3F4F6",
              "background-dark": "#0B0A0F",
              "surface-light": "#FFFFFF",
              "surface-dark": "#17161B",
              "border-light": "#E5E7EB",
              "border-dark": "#302E39",
              "text-primary-light": "#1F2937",
              "text-primary-dark": "#FFFFFF",
              "text-secondary-light": "#6B7280",
              "text-secondary-dark": "#A1A1AA",
              "text-tertiary-light": "#9CA3AF",
              "text-tertiary-dark": "#71717A",
              "button-dark": "#27252F",
              "button-hover-dark": "#312F3A",
            },
            fontFamily: {
              display: ["Space Grotesk", "sans-serif"],
              mono: ["Roboto Mono", "monospace"],
            },
            borderRadius: {
              DEFAULT: "0.75rem",
              lg: "1rem",
              full: "9999px",
            },
          },
        },
      };
    </script>
<style>
  body {
    font-family: "Space Grotesk", sans-serif;
  }

  /* container uses flex-col already via Tailwind; we just style rows */
  .chat-row {
    width: 100%;
    max-width: 720px;
    margin-inline: auto;
  }

  .chat-row-user {
    display: flex;
    justify-content: flex-end;
  }

  .chat-row-agent {
    display: flex;
    gap: 12px;
  }

  .chat-avatar {
    width: 40px;
    height: 40px;
    border-radius: 9999px;
    background: #1f2933;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
  }

  .dark .chat-avatar {
    background: #111827;
  }

  .chat-card {
    background: #111827;
    border-radius: 0.75rem;
    padding: 14px 16px;
    color: #f9fafb;
  }

  .dark .chat-card {
    background: #18181b;
  }

  .chat-card-user {
    background: #111827;
    color: #f9fafb;
    border-radius: 0.75rem;
    padding: 10px 14px;
  }

  .chat-header-line {
    font-size: 11px;
    color: #9ca3af;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .chat-header-line span.dot {
    width: 4px;
    height: 4px;
    border-radius: 9999px;
    background: #4b5563;
  }

  .chat-subtitle {
    margin-top: 4px;
    font-size: 11px;
    color: #6b7280;
  }

  .chat-body {
    margin-top: 10px;
    font-size: 14px;
    line-height: 1.55;
  }

  .chat-footer {
    margin-top: 8px;
    font-size: 11px;
    color: #9ca3af;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .chat-footer-left {
    display: flex;
    gap: 14px;
    align-items: center;
  }

  .chat-footer-btn {
    cursor: pointer;
  }

  .chat-footer-btn:hover {
    color: #e5e7eb;
  }

  .msg-user {
    /* for safety if used elsewhere */
    background: #111827;
  }

  .msg-agent {
    /* card background already set; keep class name for JS */
  }
</style>


  </head>
  <body
    class="bg-background-light dark:bg-background-dark text-text-primary-light dark:text-text-primary-dark"
  >
    <div class="flex h-screen w-full">
      <!-- Sidebar -->
      <aside
        class="w-72 bg-surface-light dark:bg-surface-dark border-r border-border-light dark:border-border-dark flex flex-col p-4"
      >
        <div class="flex items-center justify-between mb-6">
          <div class="flex items-center gap-2">
            <div
              class="w-8 h-8 bg-primary rounded-lg flex items-center justify-center"
            >
              <span class="material-symbols-outlined text-background-dark"
                >code</span
              >
            </div>
            <span class="font-bold text-lg">The Brihaspati Infotech</span>
          </div>
          <button
            class="p-1 rounded-md hover:bg-gray-200 dark:hover:bg-button-dark"
          >
            <span
              class="material-symbols-outlined text-text-secondary-light dark:text-text-secondary-dark"
              >first_page</span
            >
          </button>
        </div>

        <div class="relative mb-4">
          <span
            class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-text-tertiary-light dark:text-text-tertiary-dark"
            >search</span
          >
          <input
            class="w-full bg-background-light dark:bg-background-dark border border-border-light dark:border-border-dark rounded-md py-2 pl-10 pr-4 text-sm focus:ring-primary focus:border-primary"
            placeholder="Search threads..."
            type="text"
          />
        </div>

        <!-- <nav class="flex-grow overflow-y-auto -mr-2 pr-2">
          <ul class="space-y-4">
            <li>
              <h3
                class="text-xs font-bold uppercase text-text-tertiary-light dark:text-text-tertiary-dark mb-2 px-2"
              >
                Yesterday
              </h3>
              <ul class="space-y-1">
                <li>
                  <a
                    class="block px-2 py-1.5 rounded-md font-medium bg-primary/10 dark:bg-primary/20 text-primary"
                    href="#"
                    >Project Proposal Inquiry</a
                  >
                </li>
                <li>
                  <a
                    class="block px-2 py-1.5 rounded-md text-text-secondary-light dark:text-text-secondary-dark hover:bg-gray-100 dark:hover:bg-button-dark"
                    href="#"
                    >SEO Strategy Discussion</a
                  >
                </li>
              </ul>
            </li>
            <li>
              <h3
                class="text-xs font-bold uppercase text-text-tertiary-light dark:text-text-tertiary-dark mb-2 px-2"
              >
                Previous 7 Days
              </h3>
              <ul class="space-y-1">
                <li>
                  <a
                    class="block px-2 py-1.5 rounded-md text-text-secondary-light dark:text-text-secondary-dark hover:bg-gray-100 dark:hover:bg-button-dark"
                    href="#"
                    >E-commerce Platform Costs</a
                  >
                </li>
                <li>
                  <a
                    class="block px-2 py-1.5 rounded-md text-text-secondary-light dark:text-text-secondary-dark hover:bg-gray-100 dark:hover:bg-button-dark"
                    href="#"
                    >Branding Package Details</a
                  >
                </li>
                <li>
                  <a
                    class="block px-2 py-1.5 rounded-md text-text-secondary-light dark:text-text-secondary-dark hover:bg-gray-100 dark:hover:bg-button-dark"
                    href="#"
                    >API Integration Question</a
                  >
                </li>
              </ul>
            </li>
            <li>
              <h3
                class="text-xs font-bold uppercase text-text-tertiary-light dark:text-text-tertiary-dark mb-2 px-2"
              >
                Older
              </h3>
              <ul class="space-y-1">
                <li>
                  <a
                    class="block px-2 py-1.5 rounded-md text-text-secondary-light dark:text-text-secondary-dark hover:bg-gray-100 dark:hover:bg-button-dark"
                    href="#"
                    >Maintenance Plan Options</a
                  >
                </li>
              </ul>
            </li>
          </ul>
        </nav> -->
      </aside>

      <!-- Main area -->
      <main class="flex-1 flex flex-col h-screen">
  <!-- Header -->
  <header
    class="flex items-center justify-between p-4 border-b border-border-light dark:border-border-dark">
    <div class="flex items-center gap-2">
      <span class="font-bold">THREADS</span>
      <div class="w-px h-5 bg-border-light dark:bg-border-dark"></div>
      <div class="flex items-center gap-2">
        <div
          class="w-8 h-8 bg-primary/20 rounded-full flex items-center justify-center">
          <span class="material-symbols-outlined text-primary text-xl">psychology</span>
        </div>
        <span class="font-bold">TBI Agent</span>
      </div>
      <span id="connStatus" class="ml-3 text-xs text-green-500">connected</span>
    </div>

    <div class="flex items-center gap-4">
      <button id="stopBtn"
        class="hidden px-3 py-1 rounded-full bg-red-500/10 text-xs text-red-400 hover:bg-red-500/20">
        Stop
      </button>
      <button
        class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-button-dark">
        <span
          class="material-symbols-outlined text-text-secondary-light dark:text-text-secondary-dark">settings</span>
      </button>
      <button id="clearBtn"
        class="flex items-center gap-2 bg-button-dark hover:bg-button-hover-dark text-text-primary-dark px-4 py-2 rounded-md font-medium text-sm">
        <span class="material-symbols-outlined text-sm">spark</span>
        New Chat
      </button>
    </div>
  </header>

  <!-- Chat content -->
  <div class="flex-1 flex flex-col overflow-hidden">
    <!-- Scrollable messages area -->
    <div class="flex-1 overflow-y-auto px-6 py-6">
      <div id="messages" class="flex flex-col gap-4 max-w-3xl mx-auto">
        <!-- Empty state shown before first message -->
        <div id="emptyState"
          class="flex flex-col items-center text-center pt-10 pb-6">
          <div
            class="mb-6 px-6 py-3 bg-primary/20 rounded-full flex items-center gap-4">
            <span class="material-symbols-outlined text-primary text-3xl">hub</span>
            <span class="material-symbols-outlined text-primary text-3xl">devices</span>
          </div>
          <h1 class="text-3xl md:text-4xl font-bold mb-4 font-display">
            How can we help you with your web development needs today?
          </h1>
          <p
            class="text-sm text-text-secondary-light dark:text-text-secondary-dark max-w-xl">
            Ask anything about web design, development, performance, or SEO. The
            AgencyBot will reply with clear, actionable answers.
          </p>
        </div>
      </div>
    </div>

    <!-- Composer, fixed at bottom -->
    <section
      class="border-t border-border-light dark:border-border-dark px-4 py-4">
      <form id="chatForm"
        class="max-w-3xl mx-auto w-full"
        onsubmit="return startStream(event)">
        <div class="relative flex items-end gap-3">
          <button type="button"
            class="hidden sm:flex absolute left-2 top-1/2 -translate-y-1/2 w-9 h-9 items-center justify-center bg-button-dark text-text-primary-dark rounded-full hover:bg-button-hover-dark">
            <span
              class="material-symbols-outlined text-text-secondary-dark text-base">add</span>
          </button>

          <textarea id="messageInput" name="message" rows="1"
            class="overflow-hidden flex-1 bg-surface-light dark:bg-surface-dark border border-border-light dark:border-border-dark rounded-lg py-3 pl-3 sm:pl-14 pr-12 placeholder:text-text-tertiary-light dark:placeholder:text-text-tertiary-dark focus:ring-primary focus:border-primary text-sm resize-none"
            placeholder="Ask me anything about web design, development, or SEO..."></textarea>

          <!-- hidden model selector for JS -->
          <select id="modelSelect" class="hidden">
            <option value="default" selected>Default</option>
            <option value="fast">Fast</option>
          </select>

          <button id="sendBtn" type="submit"
            class="absolute right-2 bottom-2 h-8 w-8 rounded-full bg-primary text-background-dark flex items-center justify-center text-sm font-semibold hover:brightness-110">
            ↑
          </button>
        </div>

        <div
          class="mt-2 text-[11px] text-center text-text-tertiary-light dark:text-text-tertiary-dark">
          Press <b>Enter</b> to send • Press <b>Shift + Enter</b> for a new line
        </div>
      </form>
    </section>
  </div>

  <!-- Token elements required by JS (can be hidden) -->
  <div class="hidden">
    <span id="usedTokens">0</span>
    <span id="tokenLimit">4096</span>
    <span id="usagePercent">0%</span>
    <span id="estimatedCost">$0.0000</span>
    <div id="usageBar"></div>
  </div>
</main>

    </div>

    <script src="{% static 'agents/js/chat.js' %}"></script>
  </body>
</html>
